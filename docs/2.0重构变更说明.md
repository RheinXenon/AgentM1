# 2.0 重构变更说明

## 核心变更

### 1. 配置管理系统
新增 `config_manager.py`，实现配置持久化到 `./data/user_config.json`

**主要功能**：
- 统一管理系统配置（提示词、系统名称、RAG开关等）
- 支持配置的保存、加载和重置
- 提供默认模板

### 2. Agent可配置化
所有Agent（AgentDecision、ConversationAgent、RAG、WebSearch）现在支持：
- 接收 `config_manager` 参数初始化
- 通过 `update_prompt()` 方法动态更新提示词
- 移除硬编码的医疗相关描述

### 3. 新增API端点
- `GET /config` - 获取当前配置
- `POST /config` - 更新配置
- `POST /config/reset` - 重置为默认配置

### 4. Web界面优化
- 新增配置标签页，可在Web界面直接修改所有配置
- 支持RAG开关控制
- 自定义系统名称和欢迎消息

## 使用方式

1. 首次启动自动生成默认配置
2. 访问配置页面修改系统名称、提示词等
3. 保存配置后立即生效

## 关键提示

- 修改提示词时保留必需的变量占位符（如 `{query}`, `{conversation_history}`）
- 无知识库数据时建议禁用RAG
- 配置文件位于 `./data/user_config.json`

